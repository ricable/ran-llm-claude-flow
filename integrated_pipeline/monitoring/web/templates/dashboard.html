<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pipeline Performance Monitor</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .metric-card {
            transition: all 0.3s ease;
        }
        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-healthy { background-color: #10b981; }
        .status-warning { background-color: #f59e0b; }
        .status-critical { background-color: #ef4444; }
        
        .bottleneck-severity-low { border-left: 4px solid #10b981; }
        .bottleneck-severity-medium { border-left: 4px solid #f59e0b; }
        .bottleneck-severity-high { border-left: 4px solid #f97316; }
        .bottleneck-severity-critical { border-left: 4px solid #ef4444; }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .live-indicator {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <h1 class="text-2xl font-bold text-gray-900">Pipeline Performance Monitor</h1>
                    <div class="ml-4 flex items-center">
                        <div class="status-indicator status-healthy live-indicator"></div>
                        <span id="connection-status" class="text-sm text-green-600">Connected</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-sm text-gray-500">
                        Last Update: <span id="last-update" class="font-mono">--</span>
                    </div>
                    <button id="refresh-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium">
                        Refresh
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        
        <!-- System Health Overview -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold text-gray-900 mb-4">System Health Overview</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                
                <!-- Overall Health Score -->
                <div class="metric-card bg-white rounded-lg shadow p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <div id="health-indicator" class="status-indicator status-healthy"></div>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-gray-500">System Health</h3>
                            <p id="health-score" class="text-2xl font-semibold text-gray-900">98%</p>
                        </div>
                    </div>
                    <div class="mt-4">
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div id="health-bar" class="bg-green-500 h-2 rounded-full" style="width: 98%"></div>
                        </div>
                    </div>
                </div>

                <!-- Document Processing Rate -->
                <div class="metric-card bg-white rounded-lg shadow p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <svg class="h-8 w-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-gray-500">Processing Rate</h3>
                            <p id="processing-rate" class="text-2xl font-semibold text-gray-900">24.3</p>
                            <p class="text-xs text-gray-400">docs/hour</p>
                        </div>
                    </div>
                    <div class="mt-2">
                        <span id="rate-trend" class="text-sm text-green-600">↗ +12% vs target</span>
                    </div>
                </div>

                <!-- Memory Utilization -->
                <div class="metric-card bg-white rounded-lg shadow p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <svg class="h-8 w-8 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path>
                            </svg>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-gray-500">Memory Usage</h3>
                            <p id="memory-usage" class="text-2xl font-semibold text-gray-900">78%</p>
                            <div class="text-xs text-gray-400 mt-1">
                                <div>Rust: <span id="rust-memory">45GB</span></div>
                                <div>Python: <span id="python-memory">32GB</span></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- IPC Performance -->
                <div class="metric-card bg-white rounded-lg shadow p-6">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <svg class="h-8 w-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                            </svg>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-gray-500">IPC Latency</h3>
                            <p id="ipc-latency" class="text-2xl font-semibold text-gray-900">3.2ms</p>
                            <p class="text-xs text-gray-400">P99 latency</p>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- Performance Charts -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold text-gray-900 mb-4">Real-time Performance Metrics</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                
                <!-- Throughput Chart -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Document Processing Throughput</h3>
                    <div class="chart-container">
                        <canvas id="throughput-chart"></canvas>
                    </div>
                </div>

                <!-- Resource Utilization Chart -->
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Resource Utilization</h3>
                    <div class="chart-container">
                        <canvas id="resources-chart"></canvas>
                    </div>
                </div>

            </div>
        </div>

        <!-- Bottlenecks and Optimizations -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            
            <!-- Active Bottlenecks -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-900">Active Bottlenecks</h3>
                    <p class="text-sm text-gray-500">Performance issues requiring attention</p>
                </div>
                <div id="bottlenecks-list" class="divide-y divide-gray-200">
                    <!-- Bottlenecks will be populated here -->
                    <div class="p-6 text-center text-gray-500">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <p class="mt-2">No active bottlenecks detected</p>
                    </div>
                </div>
            </div>

            <!-- Active Optimizations -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-6 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-900">Active Optimizations</h3>
                    <p class="text-sm text-gray-500">Automatic performance improvements</p>
                </div>
                <div id="optimizations-list" class="divide-y divide-gray-200">
                    <!-- Optimizations will be populated here -->
                    <div class="p-6 text-center text-gray-500">
                        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                        </svg>
                        <p class="mt-2">No active optimizations</p>
                    </div>
                </div>
            </div>

        </div>

        <!-- Detailed Metrics Table -->
        <div class="bg-white rounded-lg shadow">
            <div class="p-6 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Detailed Performance Metrics</h3>
            </div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Metric</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Current</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Target</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Trend</th>
                        </tr>
                    </thead>
                    <tbody id="metrics-table-body" class="bg-white divide-y divide-gray-200">
                        <!-- Metrics rows will be populated here -->
                    </tbody>
                </table>
            </div>
        </div>

    </main>

    <script>
        class DashboardManager {
            constructor() {
                this.ws = null;
                this.charts = {};
                this.data = {
                    throughput: [],
                    cpu: [],
                    memory: [],
                    timestamps: []
                };
                this.maxDataPoints = 50;
                
                this.initWebSocket();
                this.initCharts();
                this.bindEvents();
                this.loadInitialData();
            }

            initWebSocket() {
                const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
                const wsUrl = `${protocol}//${window.location.host}/ws`;
                
                this.ws = new WebSocket(wsUrl);
                
                this.ws.onopen = () => {
                    console.log('WebSocket connected');
                    this.updateConnectionStatus(true);
                };
                
                this.ws.onmessage = (event) => {
                    const message = JSON.parse(event.data);
                    this.handleWebSocketMessage(message);
                };
                
                this.ws.onclose = () => {
                    console.log('WebSocket disconnected');
                    this.updateConnectionStatus(false);
                    // Reconnect after 5 seconds
                    setTimeout(() => this.initWebSocket(), 5000);
                };
                
                this.ws.onerror = (error) => {
                    console.error('WebSocket error:', error);
                    this.updateConnectionStatus(false);
                };
            }

            handleWebSocketMessage(message) {
                if (message.type === 'DashboardUpdate') {
                    this.updateMetrics(message.metrics);
                    this.updateBottlenecks(message.bottlenecks);
                    this.updateOptimizations(message.optimizations);
                    this.updateCharts(message.metrics);
                    this.updateLastUpdate(message.timestamp);
                }
            }

            updateConnectionStatus(connected) {
                const statusElement = document.getElementById('connection-status');
                const indicatorElement = statusElement.previousElementSibling;
                
                if (connected) {
                    statusElement.textContent = 'Connected';
                    statusElement.className = 'text-sm text-green-600';
                    indicatorElement.className = 'status-indicator status-healthy live-indicator';
                } else {
                    statusElement.textContent = 'Disconnected';
                    statusElement.className = 'text-sm text-red-600';
                    indicatorElement.className = 'status-indicator status-critical';
                }
            }

            updateMetrics(metrics) {
                // Update overview cards
                document.getElementById('health-score').textContent = `${Math.round(metrics.system_health_score * 100)}%`;
                document.getElementById('processing-rate').textContent = metrics.document_processing_rate.toFixed(1);
                document.getElementById('memory-usage').textContent = `${Math.round(metrics.memory_utilization)}%`;
                document.getElementById('ipc-latency').textContent = `${metrics.ipc_latency_p99.toFixed(1)}ms`;
                
                // Update health indicator
                const healthIndicator = document.getElementById('health-indicator');
                const healthBar = document.getElementById('health-bar');
                const healthPercentage = Math.round(metrics.system_health_score * 100);
                
                healthBar.style.width = `${healthPercentage}%`;
                
                if (healthPercentage >= 80) {
                    healthIndicator.className = 'status-indicator status-healthy';
                    healthBar.className = 'bg-green-500 h-2 rounded-full';
                } else if (healthPercentage >= 60) {
                    healthIndicator.className = 'status-indicator status-warning';
                    healthBar.className = 'bg-yellow-500 h-2 rounded-full';
                } else {
                    healthIndicator.className = 'status-indicator status-critical';
                    healthBar.className = 'bg-red-500 h-2 rounded-full';
                }

                // Update detailed metrics table
                this.updateMetricsTable(metrics);
            }

            updateMetricsTable(metrics) {
                const tbody = document.getElementById('metrics-table-body');
                const metricsData = [
                    {
                        name: 'CPU Utilization',
                        current: `${metrics.cpu_utilization.toFixed(1)}%`,
                        target: '< 85%',
                        status: metrics.cpu_utilization < 85 ? 'Healthy' : 'Warning',
                        trend: metrics.throughput_trend > 0 ? '↗' : metrics.throughput_trend < 0 ? '↘' : '→'
                    },
                    {
                        name: 'Memory Utilization', 
                        current: `${metrics.memory_utilization.toFixed(1)}%`,
                        target: '< 90%',
                        status: metrics.memory_utilization < 90 ? 'Healthy' : 'Warning',
                        trend: '→'
                    },
                    {
                        name: 'Document Processing Rate',
                        current: `${metrics.document_processing_rate.toFixed(1)} docs/hr`,
                        target: '20-30 docs/hr',
                        status: metrics.document_processing_rate >= 20 ? 'Healthy' : 'Warning',
                        trend: metrics.throughput_trend > 0 ? '↗' : metrics.throughput_trend < 0 ? '↘' : '→'
                    },
                    {
                        name: 'IPC Latency P99',
                        current: `${metrics.ipc_latency_p99.toFixed(1)}ms`,
                        target: '< 10ms',
                        status: metrics.ipc_latency_p99 < 10 ? 'Healthy' : 'Warning',
                        trend: '→'
                    },
                    {
                        name: 'Error Rate',
                        current: `${metrics.error_rate.toFixed(2)}%`,
                        target: '< 1%',
                        status: metrics.error_rate < 1 ? 'Healthy' : 'Critical',
                        trend: '→'
                    }
                ];

                tbody.innerHTML = metricsData.map(metric => `
                    <tr>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${metric.name}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${metric.current}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${metric.target}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${
                                metric.status === 'Healthy' ? 'bg-green-100 text-green-800' : 
                                metric.status === 'Warning' ? 'bg-yellow-100 text-yellow-800' :
                                'bg-red-100 text-red-800'
                            }">
                                ${metric.status}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${metric.trend}</td>
                    </tr>
                `).join('');
            }

            updateBottlenecks(bottlenecks) {
                const container = document.getElementById('bottlenecks-list');
                
                if (bottlenecks.length === 0) {
                    container.innerHTML = `
                        <div class="p-6 text-center text-gray-500">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <p class="mt-2">No active bottlenecks detected</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = bottlenecks.map(bottleneck => `
                    <div class="p-4 bottleneck-severity-${bottleneck.severity.toLowerCase()}">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <div class="status-indicator ${
                                    bottleneck.severity === 'Critical' ? 'status-critical' : 
                                    bottleneck.severity === 'High' ? 'status-warning' : 
                                    'status-warning'
                                }"></div>
                            </div>
                            <div class="ml-3 flex-1">
                                <h4 class="text-sm font-medium text-gray-900">${bottleneck.description}</h4>
                                <div class="mt-1 text-xs text-gray-500">
                                    Impact: ${Math.round(bottleneck.impact_score * 100)}% • 
                                    Detected: ${new Date(bottleneck.detected_at).toLocaleTimeString()}
                                </div>
                                <div class="mt-2">
                                    <div class="text-xs text-gray-600">Suggested actions:</div>
                                    <ul class="mt-1 text-xs text-gray-500 list-disc list-inside">
                                        ${bottleneck.suggested_actions.map(action => `<li>${action}</li>`).join('')}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            updateOptimizations(optimizations) {
                const container = document.getElementById('optimizations-list');
                
                if (optimizations.length === 0) {
                    container.innerHTML = `
                        <div class="p-6 text-center text-gray-500">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                            <p class="mt-2">No active optimizations</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = optimizations.map(opt => `
                    <div class="p-4">
                        <div class="flex items-start">
                            <div class="flex-shrink-0">
                                <div class="status-indicator status-healthy"></div>
                            </div>
                            <div class="ml-3 flex-1">
                                <h4 class="text-sm font-medium text-gray-900">${opt.description}</h4>
                                <div class="mt-1 text-xs text-gray-500">
                                    Expected improvement: ${Math.round(opt.expected_improvement * 100)}% • 
                                    Priority: ${opt.priority}
                                </div>
                                <div class="mt-1 flex items-center">
                                    <div class="w-full bg-gray-200 rounded-full h-1.5">
                                        <div class="bg-green-500 h-1.5 rounded-full" style="width: ${opt.expected_improvement * 100}%"></div>
                                    </div>
                                    <span class="ml-2 text-xs text-gray-500">${Math.round(opt.expected_improvement * 100)}%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `).join('');
            }

            updateCharts(metrics) {
                const now = new Date();
                
                // Add new data point
                this.data.timestamps.push(now.toLocaleTimeString());
                this.data.throughput.push(metrics.document_processing_rate);
                this.data.cpu.push(metrics.cpu_utilization);
                this.data.memory.push(metrics.memory_utilization);
                
                // Limit data points
                if (this.data.timestamps.length > this.maxDataPoints) {
                    this.data.timestamps.shift();
                    this.data.throughput.shift();
                    this.data.cpu.shift();
                    this.data.memory.shift();
                }
                
                // Update charts
                if (this.charts.throughput) {
                    this.charts.throughput.data.labels = this.data.timestamps;
                    this.charts.throughput.data.datasets[0].data = this.data.throughput;
                    this.charts.throughput.update('none');
                }
                
                if (this.charts.resources) {
                    this.charts.resources.data.labels = this.data.timestamps;
                    this.charts.resources.data.datasets[0].data = this.data.cpu;
                    this.charts.resources.data.datasets[1].data = this.data.memory;
                    this.charts.resources.update('none');
                }
            }

            updateLastUpdate(timestamp) {
                document.getElementById('last-update').textContent = new Date(timestamp).toLocaleString();
            }

            initCharts() {
                // Throughput Chart
                const throughputCtx = document.getElementById('throughput-chart').getContext('2d');
                this.charts.throughput = new Chart(throughputCtx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: 'Documents/Hour',
                            data: [],
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Documents per Hour'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Time'
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });

                // Resources Chart
                const resourcesCtx = document.getElementById('resources-chart').getContext('2d');
                this.charts.resources = new Chart(resourcesCtx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [
                            {
                                label: 'CPU %',
                                data: [],
                                borderColor: 'rgb(245, 158, 11)',
                                backgroundColor: 'rgba(245, 158, 11, 0.1)',
                                tension: 0.4
                            },
                            {
                                label: 'Memory %',
                                data: [],
                                borderColor: 'rgb(168, 85, 247)',
                                backgroundColor: 'rgba(168, 85, 247, 0.1)',
                                tension: 0.4
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                title: {
                                    display: true,
                                    text: 'Utilization %'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Time'
                                }
                            }
                        }
                    }
                });
            }

            bindEvents() {
                document.getElementById('refresh-btn').addEventListener('click', () => {
                    this.loadInitialData();
                });
            }

            async loadInitialData() {
                try {
                    // Load current metrics
                    const metricsResponse = await fetch('/api/metrics');
                    const metricsData = await metricsResponse.json();
                    
                    if (metricsData.success) {
                        this.updateMetrics({
                            cpu_utilization: metricsData.data.cpu_usage.utilization_percent,
                            memory_utilization: (metricsData.data.memory.used_bytes / metricsData.data.memory.total_bytes) * 100,
                            document_processing_rate: metricsData.data.document_processing_rate,
                            ipc_latency_p99: metricsData.data.ipc_latency_p99,
                            error_rate: metricsData.data.errors_total > 0 ? (metricsData.data.errors_total / metricsData.data.documents_processed) * 100 : 0,
                            system_health_score: 0.85,
                            throughput_trend: 0
                        });
                    }

                    // Load bottlenecks
                    const bottlenecksResponse = await fetch('/api/bottlenecks');
                    const bottlenecksData = await bottlenecksResponse.json();
                    
                    if (bottlenecksData.success) {
                        this.updateBottlenecks(bottlenecksData.data);
                    }

                    // Load optimizations
                    const optimizationsResponse = await fetch('/api/optimizations');
                    const optimizationsData = await optimizationsResponse.json();
                    
                    if (optimizationsData.success) {
                        this.updateOptimizations(optimizationsData.data);
                    }
                    
                } catch (error) {
                    console.error('Failed to load initial data:', error);
                }
            }
        }

        // Initialize dashboard when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new DashboardManager();
        });
    </script>
</body>
</html>